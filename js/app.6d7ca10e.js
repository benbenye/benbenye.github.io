(function(t){function e(e){for(var o,s,c=e[0],r=e[1],u=e[2],p=0,m=[];p<c.length;p++)s=c[p],a[s]&&m.push(a[s][0]),a[s]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);l&&l(e);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,c=1;c<n.length;c++){var r=n[c];0!==a[r]&&(o=!1)}o&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},a={app:0},i=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=r;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"3e85":function(t,e,n){},"427d":function(t,e,n){},"4e42":function(t,e,n){"use strict";var o=n("c873"),a=n.n(o);a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var o=n("2b0e"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("nav",{class:{active:"/"===t.Data.path}},[n("li",[n("router-link",{attrs:{to:"/"}},[t._v("首页")])],1),n("li",[n("router-link",{attrs:{to:"/about"}},[t._v("关于")])],1),n("li",[n("router-link",{attrs:{to:"/contents"}},[t._v("归档")])],1)]),t.Data.token?t._e():n("div",{staticClass:"token"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.token,expression:"token"}],attrs:{type:"text",placeholder:"请填写您的 github token"},domProps:{value:t.token},on:{input:function(e){e.target.composing||(t.token=e.target.value)}}}),n("button",{staticClass:"btn",on:{click:function(e){t.login(t.token)}}},[t._v("登录")])]),t.Data.token&&"/"===t.Data.path?n("router-link",{staticClass:"new-btn",attrs:{to:"/new-blog"}},[t._v("新建博客")]):t._e(),n("router-view")],1)},i=[],s={token:"",userType:"guest",path:""},c=(n("a481"),n("bc3a")),r=n.n(c),u={adminToken:["eaf774164","6b11a3d29","d029eef07c4","3c8bb2ace1f"],repoPath:"/repos/benbenye/benbenye.github.io",commentPath:"/repos/benbenye/test-issue",userType:"guest",isUseIssue:!0},l=function(){var t={Accept:"application/vnd.github.black-panther-preview+json application/vnd.github.symmetra-preview+json","Content-type":"application/json",Authorization:"token ".concat(u.adminToken.join(""))};return r.a.create({baseURL:"https://api.github.com",headers:t})},p=function(t){var e={Accept:"application/vnd.github.black-panther-preview+json application/vnd.github.symmetra-preview+json","Content-type":"application/json",Authorization:"token ".concat(t)};return r.a.create({baseURL:"https://api.github.com",headers:e})},m={testToken:function(t){var e=this;this.testAdminToken(t).then(function(n){return"ok"===n?(s.userType="admin",e.setToken(t),"ok."):e.testGuestToken(t)}).then(function(n){if("ok"!==n){if("ok."!==n)throw!1}else e.setToken(t)}).catch(function(){alert("Please rewrite your token.")})},setToken:function(t){s.token=t,localStorage.setItem("github-token","".concat(t))},testGuestToken:function(t){return p(t).post("".concat(u.commentPath,"/issues/1/comments"),{body:"test for guest token."}).then(function(){return"ok"}).catch(function(){return!1})},testAdminToken:function(t){return l().get("".concat(u.repoPath,"/contents/test-token")).then(function(e){return p(t).put("".concat(u.repoPath,"/contents/test-token"),{message:"test token",sha:e.data.sha,content:""})}).then(function(){return"ok"}).catch(function(){return!1})}};p().get("".concat(u.repoPath));function d(t){m.testToken(t)}function h(t){return t&&t.replace(/(\[\d*\])/,"")}var f={name:"App",data:function(){return{token:s.token,Data:s}},created:function(){s.path=this.$route.path},mounted:function(){s.token&&(this.token=s.token,this.token===u.adminToken.join("")&&(s.userType="admin"),d(this.token))},methods:{login:d}},v=f,b=(n("5c0b"),n("2877")),g=Object(b["a"])(v,a,i,!1,null,null,null);g.options.__file="App.vue";var _=g.exports,k=n("8c4f"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},t._l(t.files,function(e,o){return"file"===e.type&&"test-token"!==e.path&&"README.md"!==e.path?n("div",{key:o,staticClass:"post animated fadeInDown"},[n("div",{staticClass:"post-title"},[n("h3",[n("router-link",{attrs:{to:{name:"blog",params:{path:e.path}}}},[t._v(t._s(t._f("filterTitle")(e.name)))]),"admin"==t.Data.userType?[n("router-link",{attrs:{to:{name:"edit",params:{path:e.path}}}},[t._v(" [修改]")]),n("span",{class:["delete",t.deleteAble?"":"disable"],on:{click:function(n){t.cut(e)}}},[t._v("[删除]")])]:t._e()],2)]),n("div",{staticClass:"post-content",domProps:{innerHTML:t._s(t.filesContent[o])}}),t.filesTime[o]?n("div",{staticClass:"post-footer"},[n("div",{staticClass:"meta"},[t._v("\n        评论"+t._s(t.filesTime[o].data.comments||0)+"\n        "),n("div",{staticClass:"info"},[n("i",{staticClass:"fa fa-sun-o"}),n("span",{staticClass:"date"},[t._v(t._s(t._f("filterTime")(t.filesTime[o].data.created_at)))]),n("i",{staticClass:"fa fa-tag"})])])]):t._e()]):t._e()}),0)},y=[],w=(n("4917"),n("795b")),T=n.n(w),P=(n("ac6a"),n("5df3"),n("0e54")),x=n.n(P),j={name:"home",components:{},data:function(){return{files:[],filesContent:[],filesTime:[],Data:s,deleteAble:!0}},created:function(){s.path=this.$route.path},mounted:function(){var t=this;l().get("".concat(u.repoPath,"/contents")).then(function(e){return t.files=e.data,T.a.all(t.files.map(function(e){return t.getFileContents(e.path)}))}).then(function(e){return t.filesContent=e.map(function(t){var e=decodeURIComponent(escape(atob(t.data.content))),n=!!e.match(/([^]*)<!--more-->/m);return x()(n?e.match(/([^]*)<!--more-->/m)[1]:e,{sanitize:!0})}),T.a.all(t.files.map(function(e){return t.getFileTime(e.path.match(/\[(\d*)\]/)?e.path.match(/\[(\d*)\]/)[1]:null)}))}).then(function(e){t.filesTime=e})},filters:{filterTime:function(t){var e=new Date(t);return"".concat(e.getFullYear(),"年").concat(e.getMonth()+1,"月").concat(e.getDay(),"日 ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())},filterTitle:h},methods:{getFileContents:function(t){return l().get("".concat(u.repoPath,"/contents/").concat(t))},getFileTime:function(t){return t?l().get("".concat(u.commentPath,"/issues/").concat(t)):null},cut:function(t){this.deleteAble&&(this.deleteAble=!1,l().delete("".concat(u.repoPath,"/contents/").concat(t.path,"?message=delete&sha=").concat(t.sha)).then(function(){alert("delete success"),location.reload()}).catch(function(){}))}}},I=j,M=(n("a318"),Object(b["a"])(I,C,y,!1,null,null,null));M.options.__file="home.vue";var O=M.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.contents?n("marked-editor",{attrs:{editor:t.contents,type:t.type},on:{"update:editor":function(e){t.contents=e}}}):t._e()],1)},A=[],E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"header",attrs:{type:"text",placeholder:"文章标题"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),"edit"===t.type?n("button",{staticClass:"update commit",on:{click:t.update}},[t._v("更新")]):n("button",{staticClass:"create commit",on:{click:t.create}},[t._v("新建")]),"edit"===t.type?n("div",{staticClass:"main"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"editor-input",domProps:{value:t.input},on:{input:[function(e){e.target.composing||(t.input=e.target.value)},t.updateContent]}}),n("div",{staticClass:"content-preview",domProps:{innerHTML:t._s(t.compiledMarkdown)}})]):n("div",{staticClass:"main"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.createInput,expression:"createInput"}],staticClass:"editor-input",domProps:{value:t.createInput},on:{input:[function(e){e.target.composing||(t.createInput=e.target.value)},t.updateCreateContent]}}),n("div",{staticClass:"content-preview",domProps:{innerHTML:t._s(t.compiledMarkdown)}})])])},U=[],D=n("2ef0"),q=n.n(D),R={name:"MarkedEditor",props:{editor:{type:Object,required:!0},type:{type:String,required:!0}},data:function(){return{input:"edit"===this.type&&decodeURIComponent(escape(atob(this.editor.content))),createInput:"",title:this.filterUniqueId("edit"===this.type?this.editor.path:""),commitMes:"commit",uniqueTitle:""}},computed:{compiledMarkdown:function(){return"create"===this.type?"":x()(this.input,{sanitize:!0})}},methods:{updateContent:q.a.debounce(function(t){this.input=t.target.value},300),updateCreateContent:q.a.debounce(function(t){this.createInput=t.target.value},300),update:function(){var t=this;this.editor.path==="[".concat(this.editor.path.match(/\[(\d*)\]/)[1],"]").concat(this.title)?l().put("".concat(u.repoPath,"/contents/").concat(this.editor.path),{message:this.commitMes,sha:this.editor.sha,content:btoa(unescape(encodeURIComponent(this.input)))}):this.create().then(function(){l().delete("".concat(u.repoPath,"/contents/").concat(t.editor.path,"?message=delete&sha=").concat(t.editor.sha))})},create:function(){var t=this;if(u.isUseIssue)return"edit"===this.type?(this.uniqueTitle="[".concat(this.editor.path.match(/\[(\d*)\]/)[1],"]").concat(this.title),l().put("".concat(u.repoPath,"/contents/").concat(this.uniqueTitle),{message:this.commitMes,content:btoa(unescape(encodeURIComponent(this.input)))}).then().catch(function(){})):l().post("".concat(u.commentPath,"/issues"),{title:this.title,body:"https://benbenye.github.io"}).then(function(e){return t.uniqueTitle="[".concat(e.data.number,"]").concat(t.title),l().put("".concat(u.repoPath,"/contents/").concat(t.uniqueTitle),{message:t.commitMes,content:btoa(unescape(encodeURIComponent(t.createInput)))})}).catch(function(){});var e="";return e="edit"===this.type?"[".concat(this.editor.path.match(/\[(\d*)\]/)[1],"]").concat(this.title):this.title,l().put("".concat(u.repoPath,"/contents/").concat(e),{message:this.commitMes,content:btoa(unescape(encodeURIComponent(this.createInput)))}).then().catch(function(){})},filterUniqueId:function(t){return t.match(/\[\d*\]/)?t.replace(/(\[\d*\])/,""):t}}},S=R,N=(n("4e42"),Object(b["a"])(S,E,U,!1,null,null,null));N.options.__file="marked-editor.vue";var F=N.exports,L={components:{MarkedEditor:F},data:function(){return{contents:null,type:"edit"}},created:function(){s.path=this.$route.path},mounted:function(){var t=this;l().get("".concat(u.repoPath,"/contents/").concat(this.$route.params.path)).then(function(e){e.status<=299&&(t.contents=e.data)})}},z=L,H=Object(b["a"])(z,$,A,!1,null,null,null);H.options.__file="edit.vue";var G=H.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"blog"},[n("div",{staticClass:"post animated fadeInDown"},[n("div",{staticClass:"post-title"},[n("h3",[t._v(t._s(t._f("filterTitle")(t.contents&&t.contents.path)))])]),n("div",{staticClass:"post-content",domProps:{innerHTML:t._s(t.html)}}),t._m(0)]),t.number?n("comment",{attrs:{number:t.number}}):t._e()],1)},Y=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-footer"},[n("div",{staticClass:"meta"},[n("div",{staticClass:"info"},[n("i",{staticClass:"fa fa-sun-o"}),n("span",{staticClass:"date"},[t._v("2016-12-26")]),n("i",{staticClass:"fa fa-tag"})])])])}],B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment"},[n("div",{staticClass:"comment-title"},[t._v("评论")]),n("div",{staticClass:"comment-form"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.comment,expression:"comment"}],staticClass:"content-input",attrs:{placeholder:"说说你的看法"},domProps:{value:t.comment},on:{input:function(e){e.target.composing||(t.comment=e.target.value)}}}),n("button",{staticClass:"submit-btn",on:{click:t.commit}},[t._v("提交")])]),n("div",{staticClass:"comment-list"},[n("ul",t._l(t.comments,function(e,o){return n("li",{key:o,staticClass:"item"},[n("div",{staticClass:"comment-content"},[n("div",{staticClass:"user-popover-box"},[n("a",{attrs:{href:e.user.html_url,target:" blank",rel:""}},[n("div",{staticClass:"avatar",style:"background-image: url("+e.user.avatar_url+");",attrs:{title:e.user.login}})])]),n("div",{staticClass:"content-box"},[n("div",{staticClass:"header"},[n("div",{staticClass:"user-info"},[n("div",{staticClass:"user-popover-box"},[n("a",{staticClass:"username",attrs:{href:e.user.html_url,target:"_blank",rel:""}},[t._v(t._s(e.user.login))])])])]),n("div",{staticClass:"content"},[n("span",{staticClass:"content-html"},[t._v(t._s(e.body))])]),n("div",{staticClass:"footer"},[t._m(0,!0),n("span",{staticClass:"date"},[t._v(t._s(e.created_at))])])])])])}),0)])])},K=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"sub-comment-btn text-pointer"},[n("span",{staticClass:"title"},[t._v("评论")])])}],Q=(n("c5f6"),{name:"comment",components:{},props:{number:{type:Number,required:!0}},data:function(){return{comments:[],comment:""}},mounted:function(){var t=this;l().get("".concat(u.commentPath,"/issues/").concat(this.number,"/comments")).then(function(e){t.comments=e.data})},methods:{commit:function(){l().post("".concat(u.commentPath,"/issues/").concat(this.number,"/comments"),{body:this.comment}).then(function(){alert("commit success"),window.location.reload()}).catch(function(){alert("Your token illegal")})}}}),V=Q,W=(n("fc7f"),Object(b["a"])(V,B,K,!1,null,"5642b934",null));W.options.__file="comment.vue";var X=W.exports,Z={components:{Comment:X},data:function(){return{contents:null,html:"",number:0}},created:function(){s.path=this.$route.path},filters:{filterTitle:h},mounted:function(){var t=this;l().get("".concat(u.repoPath,"/contents/").concat(this.$route.params.path)).then(function(e){if(t.contents=e.data,t.html=x()(decodeURIComponent(escape(atob(t.contents.content))),{sanitize:!0}),u.isUseIssue){var n=t.$route.params.path.match(/\[(\d*)\]/);t.number=n&&+n[1]}})}},tt=Z,et=(n("7cf7"),Object(b["a"])(tt,J,Y,!1,null,null,null));et.options.__file="blog.vue";var nt=et.exports,ot=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"new"},[n("marked-editor",{attrs:{editor:t.editor,type:"create"}})],1)},at=[],it={name:"new-blog",components:{MarkedEditor:F},data:function(){return{editor:{}}},created:function(){s.path=this.$route.path}},st=it,ct=Object(b["a"])(st,ot,at,!1,null,"4aae1189",null);ct.options.__file="new-blog.vue";var rt=ct.exports;o["a"].use(k["a"]);var ut=new k["a"]({mode:"history",routes:[{path:"/",name:"home",component:O},{path:"/edit/:path",name:"edit",component:G},{path:"/blog/:path",name:"blog",component:nt},{path:"/new-blog",name:"new-blog",component:rt},{path:"/about",name:"about",component:rt},{path:"/contents",name:"contents",component:rt}]}),lt=n("9483");Object(lt["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}}),o["a"].config.productionTip=!1,s.token=localStorage.getItem("github-token"),new o["a"]({router:ut,render:function(t){return t(_)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var o=n("5e27"),a=n.n(o);a.a},"5e27":function(t,e,n){},"7cf7":function(t,e,n){"use strict";var o=n("862b"),a=n.n(o);a.a},"862b":function(t,e,n){},a318:function(t,e,n){"use strict";var o=n("427d"),a=n.n(o);a.a},c873:function(t,e,n){},fc7f:function(t,e,n){"use strict";var o=n("3e85"),a=n.n(o);a.a}});
//# sourceMappingURL=app.6d7ca10e.js.map